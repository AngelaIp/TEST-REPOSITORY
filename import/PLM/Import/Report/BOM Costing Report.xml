<AML>
 <Item type="Report" id="B932166880F84F30BB02C62E0C29CBEF" action="add">
  <description />
  <location>client</location>
  <report_query><![CDATA[<Item type="Part" action="get" select="item_number,name, cost, cost_basis" id="{@id}">
 <Relationships>
  <Item type="Part BOM" select="sort_order,quantity,related_id(item_number,name)">
   <related_id>
    <Item type="Part" select="item_number,name, cost, cost_basis">
     <Relationships>
      <Item type="Part BOM" select="sort_order,quantity,related_id(item_number,name)">
       <related_id>
        <Item type="Part" select="item_number,name, cost, cost_basis">
         <Relationships>
          <Item type="Part BOM" select="sort_order,quantity,related_id(item_number,name)">
           <related_id>
            <Item type="Part" select="item_number,name, cost, cost_basis">
             <Relationships>
              <Item type="Part BOM" select="sort_order,quantity,related_id(item_number,name)">
               <related_id>
                <Item type="Part" select="item_number,name, cost, cost_basis">
                 <Relationships>
                  <Item type="Part BOM" select="sort_order,quantity,related_id(item_number,name)">
                   <related_id>
                    <Item type="Part" select="item_number,name, cost, cost_basis"></Item>
                   </related_id>
                  </Item>
                 </Relationships>
                </Item>
               </related_id>
              </Item>
             </Relationships>
            </Item>
           </related_id>
          </Item>
         </Relationships>
        </Item>
       </related_id>
      </Item>
     </Relationships>
    </Item>
   </related_id>
  </Item>
 </Relationships>
</Item>]]></report_query>
  <target>one window</target>
  <type>item</type>
  <xsl_stylesheet><![CDATA[<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:aras="http://www.aras-corp.com">
 <xsl:output method="html" omit-xml-declaration="yes" standalone="yes" indent="yes"></xsl:output>
 <xsl:template match="/">
  <html>
   <head></head>
   <style type="text/css" userData="Global">
.cellSolid {text-align:center;border-top:1px #000000 solid;border-right:1px #000000 solid;border-bottom:1px #000000 solid;border-left:1px #000000 solid;}
.cellSolidTopRight {border-top:1px #000000 solid;border-right:1px #000000 solid;}
.cellSolidTopLeft {border-top:1px #000000 solid;border-left:1px #000000 solid;}
.cellSolidRightBottom {border-right:1px #000000 solid;border-bottom:1px #000000 solid;font-family:helvetica;font-size:8pt;}
.cellSolidBottomLeft {border-bottom:1px #000000 solid;border-left:1px #000000 solid;}
.cellSolidTop {border-top:1px #000000 solid;}
.cellSolidRight {border-right:1px #000000 solid;}
.cellSolidBottom {border-bottom:1px #000000 solid;}
.cellSolidLeft {border-left:1px #000000 solid;}
.cellDashed {border-top:1px #666666 dashed;border-right:1px #666666 dashed;border-bottom:1px #666666 dashed;border-left:1px #666666 dashed;}
.cellDashedTopRight {border-top:1px #666666 dashed;border-right:1px #666666 dashed;}
.cellDashedTopLeft {border-top:1px #666666 dashed;border-left:1px #666666 dashed;}
.cellDashedBottomRight {border-bottom:1px #666666 dashed;border-right:1px #666666 dashed;}
.cellDashedBottomLeft {border-bottom:1px #666666 dashed;border-left:1px #666666 dashed;}
.cellDashedTop {border-top:1px #666666 dashed;}
.cellDashedRight {border-right:1px #666666 dashed;}
.cellDashedBottom {border-bottom:1px #666666 dashed;}
.cellDashedLeft {border-left:1px #666666 dashed;}
.cellHeader {background-color:#CCCCCC;border-top:1px #000000 solid;border-right:1px #000000 solid;border-bottom:1px #000000 solid;padding:2px;text-align:center;text-transform:capitalize;text-align:center;font-family:helvetica;font-weight:bold;font-size:8pt;}
.cellTitle {border-top:1px #000000 solid;border-right:1px #000000 solid;border-left:1px #000000 solid;padding:2px;text-align:center;text-transform:capitalize;text-align:center;font-family:helvetica;font-weight:bold;font-size:8pt;}
</style>
   <body topmargin="50" leftmargin="50">
    <table border="0" cellspacing="0" cellpadding="0" width="850">
     <tr>
      <td width="25"></td>
      <td width="25"></td>
      <td width="25"></td>
      <td width="25"></td>
      <td width="25"></td>
      <td width="25"></td>
      <td width="150"></td>
      <td width="250"></td>
      <td width="100"></td>
      <td width="100"></td>
      <td width="100"></td>
     </tr>
     <tr valign="top">
      <td align="left" uniqueID="ms__id77" colspan="11">
       <img src="../imagesLegacy/Logos/aras_logo.gif" height="80"></img>
      </td>
     </tr>
     <tr valign="bottom">
      <td colspan="8" style="font-family:helvetica;font-size:15pt;color:#DA1943;padding:2px;" align="left" uniqueID="ms__id79">Bill of Materials Costing Report</td>
      <td colspan="3" style="font-family:helvetica;font-size:10pt;padding:2px;" align="right" uniqueID="ms__id80">Generated on: <script>function m00(r, n){r += ""; if (!n) n = 2; while(r.length &lt; n){r = "0" + r;} return r;} var dt = new Date(); var a = top.opener.top.aras; if (a){var s = m00(dt.getUTCFullYear(),4)+"-"+m00((dt.getUTCMonth()+1))+"-"+m00(dt.getUTCDate())+"T"+m00(dt.getUTCHours())+":"+m00(dt.getUTCMinutes())+":"+m00(dt.getUTCSeconds()); s = a.IomInnovator.GetI18NSessionContext().ConvertUtcDateTimeToNeutral(s, "yyyy-MM-ddTHH:mm:ss"); s = a.convertFromNeutral(s, "date", "short_date"); document.write(s);}</script></td>
     </tr>
     <tr>
      <td class="cellHeader" colspan="6" uniqueID="ms__id86" style="border-left:1px #000000 solid;">Indenture Level</td>
      <td class="cellHeader" uniqueID="ms__id89">Part Number</td>
      <td class="cellHeader" uniqueID="ms__id91">Name</td>
      <td class="cellHeader" uniqueID="ms__id88">Quantity</td>
      <td class="cellHeader" uniqueID="ms__id88">Cost</td>
      <td class="cellHeader" uniqueID="ms__id88">Cost Basis</td>
     </tr>
      <xsl:call-template name="Levels"></xsl:call-template>
    </table>
   </body>
  </html>
 </xsl:template>
 
 <!-- Find the Part Level and pass as the 'Depth' param to the next template -->
 <xsl:template name="Levels">
  <xsl:for-each select="//Item[@type='Part']">
   <xsl:apply-templates mode="PartBOM" select=".">
    <xsl:with-param name="Depth" select="count(ancestor::Relationships)"></xsl:with-param>
   </xsl:apply-templates>
  </xsl:for-each>
 </xsl:template>
 
 <xsl:template mode="PartBOM" match="//Item[@type='Part']">
  <xsl:param name="Depth"></xsl:param>
  <tr>
   <xsl:choose>
    <xsl:when test="$Depth = '0'">
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id92" align="center" style="border-left:1px #000000 solid;">
      <xsl:value-of select="$Depth"></xsl:value-of>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id93">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id94">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id96">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id196">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id60">
      <xsl:text>&#160;</xsl:text>
     </td>
    </xsl:when>
    <xsl:when test="$Depth = '1'">
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id97" style="border-left:1px #000000 solid;">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id98" align="center">
      <xsl:value-of select="$Depth"></xsl:value-of>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id99">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id100">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id101">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id61">
      <xsl:text>&#160;</xsl:text>
     </td>
    </xsl:when>
    <xsl:when test="$Depth = '2'">
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id102" style="border-left:1px #000000 solid;">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id103">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id104" align="center">
      <xsl:value-of select="$Depth"></xsl:value-of>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id105">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id198">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id62">
      <xsl:text>&#160;</xsl:text>
     </td>
    </xsl:when>
    <xsl:when test="$Depth = '3'">
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id107" style="border-left:1px #000000 solid;">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id108">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id109">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id110" align="center">
      <xsl:value-of select="$Depth"></xsl:value-of>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id111">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id63">
      <xsl:text>&#160;</xsl:text>
     </td>
    </xsl:when>
    <xsl:when test="$Depth = '4'">
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id112" style="border-left:1px #000000 solid;">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id113">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id114">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id115">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id116" align="center">
      <xsl:value-of select="$Depth"></xsl:value-of>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id64">
      <xsl:text>&#160;</xsl:text>
     </td>
    </xsl:when>
    <xsl:when test="$Depth = '5'">
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id201" style="border-left:1px #000000 solid;">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id202">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id203">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id204">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id206">
      <xsl:text>&#160;</xsl:text>
     </td>
     <td class="cellSolidRightBottom" width="20pt" uniqueID="ms__id205" align="center">
      <xsl:value-of select="$Depth"></xsl:value-of>
     </td>
    </xsl:when>
   </xsl:choose>
   <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" uniqueID="ms__id28">
    <xsl:value-of select="item_number"></xsl:value-of>
    <xsl:if test="item_number='' or not(item_number)"><xsl:text>&#160;</xsl:text></xsl:if>
   </td>
   <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" uniqueID="ms__id27">
    <xsl:value-of select="name"></xsl:value-of>
    <xsl:if test="name='' or not(name)"><xsl:text>&#160;</xsl:text></xsl:if>
   </td>
   <xsl:choose>
    <xsl:when test="../../quantity != '0'">
     <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" align="center" uniqueID="ms__id29">
      <xsl:value-of select="../../quantity"></xsl:value-of>
      <xsl:if test="../../quantity='' or not(../../quantity)"><xsl:text>&#160;</xsl:text></xsl:if>
     </td>
    </xsl:when>
	<xsl:when test="$Depth = '0'">
     <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" align="center" uniqueID="ms__id29">1</td>
	</xsl:when>
    <xsl:otherwise>
     <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" align="center" uniqueID="ms__id29">0</td>
    </xsl:otherwise>
   </xsl:choose>
   <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" uniqueID="ms__id27">
    <xsl:value-of select="cost"></xsl:value-of>
    <xsl:if test="cost='' or not(cost)"><xsl:text>&#160;</xsl:text></xsl:if>
   </td>
   <td class="cellSolidRightBottom" style="font-family:helvetica; font-size:8pt; padding:2px;" uniqueID="ms__id27">
    <xsl:value-of select="cost_basis"></xsl:value-of>
    <xsl:if test="cost_basis='' or not(cost_basis)"><xsl:text>&#160;</xsl:text></xsl:if>
   </td>  </tr>
 </xsl:template>
</xsl:stylesheet>
]]></xsl_stylesheet>
  <name>BOM Costing Report</name>
 </Item>
</AML>
<AML>
 <Item type="Method" id="8DDB141EC947462BABFA4E7103CCF25E" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[
window.setPartsTabVisilbe = function(isvisible)
{
  if(!parent.relationships || parent.relationships.relTabbar.GetTabOrder("|") === "")
	{
	  setTimeout("window.setPartsTabVisilbe(" + isvisible + ")", 100);
		return;
	}
	
	var relshipId = top.aras.getRelationshipTypeId("CAD Part");
	parent.relationships.relTabbar.SetTabVisible(relshipId , isvisible);
}
	
retrievePart();

function retrievePart()
	{
		if (!document.thisItem || !document.getElementById("part") || !document.getElementById("partid") || !document.getElementById("partupdated"))
		{
			return;
		}

		document.getElementById("partupdated").style.display = "none";
		        
		var aml = "" +
		"<AML>" +
		"	<Item type='CAD' id='" + document.thisItem.getID() + "' resolution='Standard' action='PE_GetRelatedParts'>" +
		"		<Relationships>" +
		"			<Item type='Part CAD' select='related_id(id)'>" +
		"				<source_id>" +
		"					<Item type='Part' select='id,keyed_name' maxRecords='2'>" +
		"					</Item>" +
		"				</source_id>" +
		"			</Item>" +
		"		</Relationships>" +
		"	</Item>" +
		"</AML>";

		var tempItem = document.thisItem.newItem();
		tempItem.loadAML(aml);
		tempItem = tempItem.apply();

		if (tempItem.getItemCount() <= 0)
		{
			window.setPartsTabVisilbe(false);
			return;
		}
		
		var relshipId = top.aras.getRelationshipTypeId("CAD Part");
		
		if(tempItem.getItemCount() == 1)
		{
			var textPropName = top.aras.browserHelper.getTextContentPropertyName();
		  document.getElementById("part")[textPropName] = tempItem.getProperty("keyed_name");
		  document.getElementById("partid").value = tempItem.getProperty("id");
		  
		  var isLinked = tempItem.getProperty("is_linked") == "1";
		  SetLink(isLinked);
		  
			window.setPartsTabVisilbe(false);
		}
		else
		{
		  document.getElementById("part").innerHTML = "See tab"
		  document.getElementById("partid").value = "tab";
		  window.setPartsTabVisilbe(true);
		}
	}

	function SetLink(isLinked) {
		var partupdated = document.getElementById("partupdated");
		partupdated.style.display = "inline";
		partupdated.src = isLinked ? "../images/RelationshipType.svg" : "../images/NoRelationship.svg";
		partupdated.width = 16;
		partupdated.height = 16;
	}
]]></method_code>
  <method_type>JavaScript</method_type>
  <name>PE_retrievePartOnCADForm</name>
 </Item>
</AML>